# UI Inspector - 类似inspect.exe的UI自动化检查工具

这是一个使用C#和WPF开发的UI自动化检查工具，功能类似于Windows SDK中的inspect.exe工具。它可以帮助开发者检查和分析Windows应用程序的UI元素结构、属性和自动化模式。

## 功能特性

### 核心功能
- **控件层次结构浏览**: 以树形结构显示桌面上的所有窗口和控件
- **属性检查**: 显示选中控件的详细属性信息
- **模式支持检测**: 检查控件支持的UI自动化模式
- **实时刷新**: 动态刷新UI元素结构

### 高级功能
- **高亮显示**: 高亮显示选中的UI元素，便于定位
- **截图功能**: 对选中的控件进行截图
- **窗口查找**: 根据标题、类名、进程ID等条件查找窗口
- **控件查找**: 根据名称、自动化ID、控件类型等条件查找控件

## 系统要求

- Windows 10/11
- .NET 8.0 或更高版本
- 管理员权限（某些功能需要）

## 安装和运行

1. 克隆或下载项目代码
2. 使用Visual Studio 2022或更高版本打开解决方案
3. 还原NuGet包
4. 编译并运行项目

```bash
# 使用命令行编译
dotnet restore
dotnet build
dotnet run
```

## 使用说明

### 基本操作

1. **启动应用**: 运行程序后，会自动加载桌面上的所有窗口
2. **浏览控件**: 在左侧树形视图中展开节点查看控件层次结构
3. **查看属性**: 点击任意控件，右侧面板会显示其详细属性
4. **刷新数据**: 点击"刷新"按钮重新加载UI元素

### 高级功能

#### 高亮显示
1. 在树形视图中选择要高亮的控件
2. 点击"高亮显示"按钮
3. 选中的控件会被红色边框高亮显示
4. 再次点击按钮取消高亮

#### 截图功能
1. 选择要截图的控件
2. 点击"截图"按钮
3. 截图会自动保存到程序目录下

#### 查找窗口
1. 点击"查找窗口"按钮
2. 在弹出的对话框中输入查找条件
3. 点击"查找"按钮搜索匹配的窗口
4. 从结果列表中选择目标窗口

#### 查找控件
1. 点击"查找控件"按钮
2. 在弹出的对话框中输入查找条件
3. 点击"查找"按钮搜索匹配的控件
4. 从结果列表中选择目标控件

## 技术架构

### 核心技术
- **WPF**: 用户界面框架
- **UI Automation**: Windows UI自动化API
- **System.Drawing**: 图像处理（截图功能）

### 项目结构
```
window_tools/
├── MainWindow.xaml          # 主界面
├── MainWindow.xaml.cs       # 主界面逻辑
├── HighlightWindow.cs       # 高亮窗口
├── FindWindowDialog.xaml    # 查找窗口对话框
├── FindWindowDialog.xaml.cs # 查找窗口逻辑
├── FindControlDialog.xaml   # 查找控件对话框
├── FindControlDialog.xaml.cs # 查找控件逻辑
└── README.md               # 项目说明
```

## 支持的控件类型

工具支持检查以下类型的UI控件：
- Button (按钮)
- Edit (编辑框)
- Text (文本)
- ComboBox (组合框)
- List (列表)
- Tree (树形控件)
- Tab (标签页)
- Menu/MenuItem (菜单)
- CheckBox (复选框)
- RadioButton (单选按钮)
- Slider (滑块)
- ProgressBar (进度条)
- ScrollBar (滚动条)
- ToolBar (工具栏)
- StatusBar (状态栏)
- ToolTip (工具提示)
- Group (分组)
- Pane (面板)
- Window (窗口)
- Document (文档)

## 支持的UI自动化模式

工具可以检测以下UI自动化模式的支持情况：
- InvokePattern (调用模式)
- ValuePattern (值模式)
- TextPattern (文本模式)
- SelectionPattern (选择模式)
- SelectionItemPattern (选择项模式)
- ScrollPattern (滚动模式)
- ExpandCollapsePattern (展开折叠模式)
- TogglePattern (切换模式)
- TransformPattern (变换模式)
- WindowPattern (窗口模式)
- DockPattern (停靠模式)
- GridPattern (网格模式)
- TablePattern (表格模式)
- RangeValuePattern (范围值模式)
- 以及其他更多模式...

## 故障排除

### 常见问题

1. **无法访问某些控件**
   - 确保以管理员权限运行程序
   - 某些系统控件可能有访问限制

2. **高亮显示不工作**
   - 检查目标控件是否可见
   - 确保控件没有被其他窗口遮挡

3. **截图功能失败**
   - 确保有足够的磁盘空间
   - 检查程序目录的写入权限

4. **查找功能无结果**
   - 检查查找条件是否正确
   - 尝试使用更宽松的搜索条件

### 性能优化

- 对于大型应用程序，建议只展开需要的节点
- 定期刷新以获取最新的UI状态
- 避免同时高亮显示过多元素

## 开发计划

### 已实现功能
- ✅ 基本UI元素浏览
- ✅ 属性检查
- ✅ 模式支持检测
- ✅ 高亮显示
- ✅ 截图功能
- ✅ 窗口查找
- ✅ 控件查找
- ✅ 鼠标点击获取控件句柄

## 贡献指南

欢迎提交Issue和Pull Request来改进这个工具。

### 开发环境设置
1. 安装Visual Studio 2022
2. 安装.NET 8.0 SDK
3. 克隆项目代码
4. 打开解决方案并还原包

### 代码规范
- 使用C#编码规范
- 添加适当的注释
- 编写单元测试
- 确保代码可读性

## 许可证

本项目采用MIT许可证。详见LICENSE文件。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**注意**: 此工具仅用于开发和测试目的，请勿用于恶意用途。使用本工具时请遵守相关法律法规和软件许可协议。 