# Window Tools v2.0 部署说明

## 问题解决

您遇到的错误 `NETSDK1064: 未找到版本为 8.0.0 的包 Microsoft.Win32.SystemEvents` 已经通过以下步骤解决：

1. **清理项目**: `dotnet clean`
2. **清除NuGet缓存**: `dotnet nuget locals all --clear`
3. **重新还原包**: `dotnet restore`
4. **构建Release版本**: `dotnet build --configuration Release`

## 发布版本

已成功创建以下发布版本：

### 1. 完整发布版本 (`publish/`)
- 包含所有依赖文件的完整版本
- 文件较多，但包含完整的运行时环境
- 适合需要完整功能的场景

### 2. 便携版发布版本 (`publish-portable/`)
- 单文件可执行程序 (146MB)
- 包含所有必要的运行时组件
- 可以在任何Windows 10+电脑上运行，无需安装.NET运行时
- **推荐用于分发到其他电脑**

### 3. 压缩包 (`WindowTools_v2.0_Release.zip`)
- 便携版的压缩包 (63MB)
- 包含使用说明和启动脚本
- 方便分发和传输

## 使用方法

### 在其他电脑上运行

1. **解压压缩包** `WindowTools_v2.0_Release.zip`
2. **双击** `运行程序.bat` 或直接运行 `window_tools.exe`
3. **无需安装任何额外软件**

### 系统要求

- Windows 10 或更高版本
- x64 架构处理器
- 至少 200MB 可用磁盘空间
- 建议 4GB 以上内存

## 文件说明

### 便携版包含的文件：
- `window_tools.exe` (146MB) - 主程序文件
- `*.dll` 文件 - 运行时依赖库
- `window_tools.pdb` - 调试符号文件（可选）
- `README.txt` - 使用说明
- `运行程序.bat` - 启动脚本

## 故障排除

如果程序无法运行，请尝试：

1. **以管理员身份运行**
   - 右键点击 `window_tools.exe`
   - 选择"以管理员身份运行"

2. **检查防病毒软件**
   - 某些防病毒软件可能误报
   - 将程序添加到白名单

3. **检查系统兼容性**
   - 确保是Windows 10或更高版本
   - 确保是x64架构

4. **检查磁盘空间**
   - 确保有足够的可用空间

## 技术细节

- **目标框架**: .NET 8.0
- **运行时**: win-x64
- **构建配置**: Release
- **发布类型**: 自包含 (Self-contained)
- **单文件**: 是

## 分发建议

1. **使用压缩包分发**: `WindowTools_v2.0_Release.zip`
2. **提供使用说明**: 包含README.txt文件
3. **测试兼容性**: 在不同Windows版本上测试
4. **版本管理**: 建议使用版本号管理不同发布版本

## 构建命令

如果需要重新构建，可以使用以下命令：

```bash
# 清理和还原
dotnet clean
dotnet nuget locals all --clear
dotnet restore

# 构建Release版本
dotnet build --configuration Release

# 发布便携版
dotnet publish --configuration Release --runtime win-x64 --self-contained true --output ./publish-portable -p:PublishSingleFile=true
```

## 注意事项

- 程序文件较大是因为包含了完整的.NET运行时
- 首次运行可能需要几秒钟启动时间
- 建议在目标环境测试后再分发
- 定期更新以修复潜在问题 